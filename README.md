# ЗооМагазин - Web приложение для управления зоомагазином

Полнофункциональное веб-приложение на Spring Boot с авторизацией и разделением ролей.

## Описание предметной области

Приложение представляет собой информационную систему для управления интернет-магазином товаров для животных (зоомагазин). Система автоматизирует процессы продажи зоотоваров и обеспечивает взаимодействие между основными участниками бизнес-процессов: клиентами, поставщиками и администраторами.

### Основные бизнес-процессы:

1. **Управление товарами** — система хранит информацию о товарах (корм для животных, аксессуары, игрушки и т.д.), их категориях, ценах, количестве на складах, а также привязку к поставщикам.

2. **Управление складами** — учет товаров на различных складах с указанием их адресов и контактной информации.

3. **Работа с поставщиками** — каждый поставщик может управлять своими товарами: добавлять новые позиции, редактировать информацию о товарах, отслеживать статистику.

4. **Оформление заказов** — клиенты могут просматривать каталог товаров, формировать заказы, отслеживать их статус и историю покупок.

5. **Система отзывов** — клиенты могут оставлять отзывы и оценки (рейтинг от 1 до 5) на приобретенные товары, что помогает другим покупателям в выборе.

6. **Управление пользователями и доступом** — система поддерживает три роли пользователей:
   - **Клиент (CLIENT)** — просмотр каталога, оформление заказов, оставление отзывов
   - **Поставщик (SUPPLIER)** — управление своими товарами
   - **Администратор (ADMIN)** — полный контроль над системой, управление всеми сущностями

### Основные сущности предметной области:

- **Товары** — основная сущность системы, включает название, описание, цену, количество, категорию, склад хранения и поставщика
- **Категории товаров** — классификация товаров по типам (например, корма, игрушки, аксессуары)
- **Склады** — места хранения товаров с информацией об адресах
- **Поставщики** — компании или физические лица, поставляющие товары в магазин
- **Заказы** — покупки клиентов с указанием статуса, суммы, адреса доставки
- **Позиции заказов** — детализация заказов (какие товары, в каком количестве, по какой цене)
- **Отзывы** — оценки и комментарии клиентов о товарах
- **Пользователи** — зарегистрированные пользователи системы с различными ролями и правами доступа

## Возможности

### Для всех ролей
- Авторизация и регистрация
- Современный веб-интерфейс на Thymeleaf

### Клиент (CLIENT)
- Просмотр каталога товаров
- Фильтрация по категориям
- Просмотр деталей товара
- Просмотр и добавление отзывов
- Просмотр истории заказов

### Поставщик (SUPPLIER)
- Управление товарами (CRUD)
- Просмотр статистики товаров
- Добавление/редактирование своих товаров

### Администратор (ADMIN)
- Полный доступ ко всем таблицам
- Управление пользователями
- Управление ролями
- Управление товарами
- Управление категориями
- Управление складами
- Управление поставщиками
- Управление заказами
- Управление отзывами

## Структура базы данных

Приложение использует 9 связанных таблиц:

1. **users** - Пользователи системы
2. **roles** - Роли системы
3. **user_roles** - Связь пользователей и ролей (Many-to-Many)
4. **categories** - Категории товаров
5. **warehouses** - Склады
6. **suppliers** - Поставщики
7. **products** - Товары
8. **orders** - Заказы
9. **order_items** - Элементы заказов
10. **reviews** - Отзывы о товарах

### Связи между таблицами
- users ↔ roles (Many-to-Many через user_roles)
- users → suppliers (1:1)
- suppliers → products (1:N)
- categories → products (1:N)
- warehouses → products (1:N)
- users → orders (1:N)
- orders → order_items (1:N)
- products → order_items (1:N)
- users → reviews (1:N)
- products → reviews (1:N)

## Требования

- Java 17+
- Maven 3.6+
- PostgreSQL 12+

## Настройка базы данных

1. Создайте базу данных:
```sql
CREATE DATABASE zoo_shop1;
```

2. Настройка подключения в `src/main/resources/application.properties`:
```
spring.datasource.url=jdbc:postgresql://localhost:5432/zoo_shop1
spring.datasource.username=postgres
spring.datasource.password=1
```

3. Приложение автоматически создаст таблицы при первом запуске (spring.jpa.hibernate.ddl-auto=update)

### Тестовые данные

В файле `src/main/resources/db/schema.sql` есть SQL-скрипт с тестовыми данными для категорий и складов.

**Администратор по умолчанию:**
- Username: `admin`
- Password: `admin`

## Запуск приложения

### Через Maven
```bash
mvn clean install
mvn spring-boot:run
```

### Через IDE
Запустите класс `DemoApplication.java`

Приложение будет доступно по адресу: `http://localhost:8080`

## Структура проекта

```
src/main/java/com/example/demo/
├── DemoApplication.java          # Главный класс приложения
├── config/
│   ├── SecurityConfig.java       # Конфигурация Spring Security
│   └── CustomUserDetailsService.java  # Сервис авторизации
├── controller/
│   ├── AuthController.java       # Контроллер авторизации
│   ├── HomeController.java       # Главная страница
│   ├── ClientController.java     # Контроллер для клиентов
│   ├── SupplierController.java   # Контроллер для поставщиков
│   └── AdminController.java      # Контроллер для администраторов
├── model/
│   ├── User.java                 # Модель пользователя
│   ├── Role.java                 # Роли пользователей
│   ├── Category.java             # Модель категории
│   ├── Warehouse.java            # Модель склада
│   ├── Supplier.java             # Модель поставщика
│   ├── Product.java              # Модель товара
│   ├── Order.java                # Модель заказа
│   ├── OrderItem.java            # Модель элемента заказа
│   └── Review.java               # Модель отзыва
├── repository/                   # JPA репозитории
│   ├── UserRepository.java
│   ├── CategoryRepository.java
│   ├── WarehouseRepository.java
│   ├── SupplierRepository.java
│   ├── ProductRepository.java
│   ├── OrderRepository.java
│   ├── OrderItemRepository.java
│   └── ReviewRepository.java
└── service/
    └── UserService.java          # Сервис для работы с пользователями

src/main/resources/
├── templates/
│   ├── login.html               # Страница входа
│   ├── register.html            # Страница регистрации
│   ├── fragments/
│   │   └── header.html          # Общий заголовок
│   ├── client/
│   │   ├── products.html        # Каталог товаров
│   │   ├── product-details.html # Детали товара
│   │   ├── orders.html          # Заказы клиента
│   │   └── dashboard.html       # Главная клиента
│   ├── supplier/
│   │   ├── dashboard.html       # Главная поставщика
│   │   ├── products.html        # Товары поставщика
│   │   └── product-form.html    # Форма товара
│   └── admin/
│       ├── dashboard.html       # Главная админа
│       ├── users.html           # Список пользователей
│       ├── user-form.html       # Форма пользователя
│       ├── products.html        # Список товаров
│       ├── product-form.html    # Форма товара
│       ├── categories.html      # Категории
│       ├── category-form.html   # Форма категории
│       ├── warehouses.html      # Склады
│       ├── warehouse-form.html  # Форма склада
│       ├── suppliers.html       # Поставщики
│       ├── supplier-form.html   # Форма поставщика
│       ├── orders.html          # Заказы
│       └── reviews.html         # Отзывы
├── static/
│   └── css/
│       └── style.css            # Стили приложения
├── db/
│   └── schema.sql               # SQL скрипт с тестовыми данными
└── application.properties       # Конфигурация приложения
```

## Используемые технологии

- **Spring Boot 3.1.4** - фреймворк
- **Spring Security** - авторизация и аутентификация
- **Spring Data JPA** - работа с базой данных
- **Thymeleaf** - шаблонизатор
- **PostgreSQL** - база данных
- **Maven** - управление зависимостями
- **Hibernate** - ORM
- **BCrypt** - хеширование паролей

## Валидация

Все формы имеют валидацию:
- Email проверяется на корректный формат
- Пароль минимальная длина 3 символа
- Цены и количества не могут быть отрицательными
- Обязательные поля отмечены в формах

## Безопасность

- Пароли хешируются с помощью BCrypt
- Используется Spring Security для авторизации
- Доступ к разным страницам в зависимости от роли
- Защита от CSRF (отключена для упрощения)

## Разделение ролей

### CLIENT (Клиент)
- Доступ к каталогу товаров
- Просмотр своих заказов
- Добавление отзывов

### SUPPLIER (Поставщик)
- Управление своими товарами
- Просмотр статистики

### ADMIN (Администратор)
- Полный доступ ко всем функциям
- Управление всеми таблицами
- Просмотр всех заказов и отзывов

## Разработка

При разработке учитывались:
- Принципы SOLID
- Паттерн MVC
- Валидация данных
- Безопасность приложения
- Удобный пользовательский интерфейс
- Адаптивный дизайн

## Автор

Система разработана для учебных целей.

## Лицензия

MIT License
